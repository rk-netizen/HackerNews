<div class="max-w-4xl mx-auto p-4">
  <div class="flex gap-3 mb-6">
    <button
      (click)="switchMode('top')"
      [class]="getButtonClasses('top')"
      class="px-4 py-2 rounded-lg border transition-colors"
    >
      Top Stories
    </button>
    <button
      (click)="switchMode('new')"
      [class]="getButtonClasses('new')"
      class="px-4 py-2 rounded-lg border transition-colors"
    >
      New Stories
    </button>
  </div>

  <div class="mb-6">
    <app-search-bar
      placeholder="Search stories by title, URL, or author..."
      [value]="searchQuery()"
      (searchChange)="onSearchChange($event)"
      (clear)="onSearchClear()"
    />
  </div>

  @if (loading() && stories().length === 0) {
  <app-loading-state message="Loading stories..." />
  } @if (error() && !loading()) {
  <app-error-state [message]="error()!" (retry)="refresh()" />
  } @if (stories().length > 0) {

  <div class="space-y-4">
    @for (story of stories(); track story.id) {
    <app-post-card [post]="story"></app-post-card>
    }
  </div>

  <div class="text-sm text-gray-500 text-center mt-4">Showing {{ stories().length }} stories</div>

  @if (hasMore()) {
  <div class="mt-6 flex justify-center">
    <button
      (click)="loadMore()"
      [disabled]="!canLoadMore()"
      class="px-6 py-3 bg-blue-600 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition-all hover:bg-blue-700 min-h-[48px] inline-flex items-center justify-center"
    >
      @if (loading()) {
      <div class="flex items-center gap-2">
        <div
          class="w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"
          aria-label="Loading"
        ></div>
        <span>Loading more...</span>
      </div>
      } @else {
      <span>Load More Stories</span>
      }
    </button>
  </div>
  } @else {
  <div class="text-center mt-6 text-gray-500">All stories loaded</div>
  } } @if (stories().length === 0 && !loading() && !error()) {
  <app-empty-state
    title="No stories found"
    description="There are no stories available right now. Try refreshing or check back later."
    actionText="Refresh"
    (refresh)="refresh()"
  />
  }
</div>
